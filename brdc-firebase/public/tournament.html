<!DOCTYPE html>
<html>
<head>
  <title>Tournament | BRDC</title>
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getFirestore, doc, getDoc, collection, query, where, getDocs } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
    import { EventCard } from '/components.js';

    const app = initializeApp({/*config*/});
    const db = getFirestore(app);
    const tournamentId = new URLSearchParams(location.search).get('id');

    async function load() {
      const tournamentDoc = await getDoc(doc(db, 'tournaments', tournamentId));
      const tournament = tournamentDoc.data();
      const eventsSnap = await getDocs(query(collection(db, 'events'), where('tournament_id', '==', tournamentId)));
      const events = eventsSnap.docs.map(d => d.data());
      
      document.title = `${tournament.tournament_name} | BRDC`;
      document.body.innerHTML = `
        <h1>${tournament.tournament_name}</h1>
        <p>${tournament.tournament_date.toDate().toLocaleDateString()} â€¢ ${tournament.venue_name}</p>
        <div class="events-grid">${events.map(e => EventCard({ event: e, tournament })).join('')}</div>
      `;
    }
    load();
  </script>
</head>
<body></body>
</html>